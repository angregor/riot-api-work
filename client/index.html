<!DOCTYPE html>
<html>

<head>
<title>API Test</title>
<!-- Dependencies (WORKING)-->

<!-- Bootstrap -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

<!-- jQuery -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.4/jquery-ui.min.js"></script>

<!-- Angular -->
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>

<!-- Bootstrap Script-->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- My Javascript -->

<script>
function getSummoner() {
  var mykey = "70ce1698-3e0d-42ce-a885-14d6da5cd691";
  var myname = $("#username").val().toLowerCase();
  var summonercall = "https://na.api.pvp.net/api/lol/na/v1.4/summoner/by-name/"+ myname +"?api_key=" + mykey;

  console.log(myname);
  //look up summoner based on name
  $.ajax({
    url: "https://na.api.pvp.net/api/lol/na/v1.4/summoner/by-name/"+ myname +"?api_key=" + mykey,
    type: 'GET',
    dataType: 'json',
    data: {

    },
    success: function (summoner) {
      console.log("got summoner");
      console.log(summoner);
      var name = summoner[myname].name.toString();
      var level = summoner[myname].summonerLevel.toString();
      var id = summoner[myname].id.toString();
      $('#summonernameid').text(name);
      $('#summonerlevelid').text(level);
      //now look up ranked info
      $.ajax({
        url: "https://na.api.pvp.net/api/lol/na/v2.5/league/by-summoner/" + id + "/entry?api_key=" + mykey,
        type: 'GET',
        dataType: 'json',
        data: {

        },
        success: function (summoner) {
          var league = summoner[id][0].entries[0].division;
          var leaguepoints = summoner[id][0].entries[0].leaguePoints.toString();
          var tier = summoner[id][0].tier.toString();
          var rank = tier + " " + league + ": " + leaguepoints + "LP";
          console.log(tier);
          $('#summonerrankid').text(rank);
        },
        error: function (XMLHttpRequest, textStatus, errorThrown) {
          alert("error getting ranked info");
          $('#summonerrankid').text("Unranked!");
        }

      });
    },
    error: function (XMLHttpRequest, textStatus, errorThrown) {
      console.log(XMLHttpRequest);
      alert("error getting summoner");
      console.log(textStatus);
    }
  });
}
</script>

<!--End Dependencies -->

</head>

<body>
    <h2> Enter your summoner name: </h2>
        <input id="username" />
        <input class="btn-primary" onclick="getSummoner();" type="submit" />
      <h1> Summoner Name: <h2 id="summonernameid"></h2></h1>
      <h1> Summoner Level: <h2 id="summonerlevelid"></h2></h1>
      <h1> Summoner Rank: <h2 id="summonerrankid"></h2></h1>
</body>

</html>
